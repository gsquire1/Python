<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>anturlar &mdash; SQA_automation 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SQA_automation 1.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">SQA_automation 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for anturlar</h1><div class="highlight"><pre>
<span class="c">#!/opt/python3/bin/python3</span>

<span class="kn">import</span> <span class="nn">telnetlib</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">sys</span>
<span class="c">#import argparse</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">var</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">liabhar</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="n">error</span> <span class="k">as</span> <span class="n">SocketError</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Note: Naming conventions follow the typical Python conventions</span>

<span class="sd">module_name                     package_name            </span>
<span class="sd">method_name                     ExceptionName           </span>
<span class="sd">global_var_name                 instance_var_name</span>
<span class="sd">function_parameter_name         local_var_name</span>
<span class="sd">GLOBAL_CONSTANT_NAME            ClassName</span>
<span class="sd">                                function_name                                </span>
<span class="sd">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="FabricInfo"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo">[docs]</a><span class="k">class</span> <span class="nc">FabricInfo</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a class to return iformations about a Fabric including</span>
<span class="sd">        The FID is required make the class specific to the FID</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fid</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fid</span> <span class="o">=</span> <span class="n">fid</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">initializing Fabric Info class  &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fid</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__change_fid__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;setcontext &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fid</span><span class="p">))</span>
        
<div class="viewcode-block" id="FabricInfo.sid_numbers"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.sid_numbers">[docs]</a>    <span class="k">def</span> <span class="nf">sid_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string of the members of the current fabric</span>
<span class="sd">            Return none if no switches are found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__change_fid__</span><span class="p">()</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fabricshow&quot;</span><span class="p">)</span>
        
        <span class="c">#### the next two lines would return each item from the fabricshow command</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3}):\s+([\d\w]{6})\s+([:\d\w]{23})\s+([.\d]{7,15})\s+([.\d]{7,15})\s+([&quot;_\w\d]+)&#39;</span><span class="p">)</span>
        <span class="n">ras_result</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="c">#### the above two lines not used here</span>
        
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3}):\s+&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
        <span class="c">#print(&quot;\n\n\n\n&quot;, ras_result_all, &quot;ras_result_all\n\n\n&quot;)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="n">ras_result_all</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span>
           
        <span class="k">return</span> <span class="n">ras_result_all</span>
    </div>
<div class="viewcode-block" id="FabricInfo.switch_count"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.switch_count">[docs]</a>    <span class="k">def</span> <span class="nf">switch_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return the number of switches in the FID</span>
<span class="sd">            Return 0 if no match is found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__change_fid__</span><span class="p">()</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fabricshow&quot;</span><span class="p">)</span>
        
        <span class="c">#### the next two lines would return each item from the fabricshow command</span>
        <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3}):\s+([\d\w]{6})\s+([:\d\w]{23})\s+([.\d]{7,15})\s+([.\d]{7,15})\s+([&quot;_\w\d]+)&#39;)</span>
        <span class="c">#ras_result = ras.search(capture_cmd)</span>
        <span class="c">#### the above two lines not used here</span>
        
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;Fabric has\s?([0-9]{1,3})&#39;</span><span class="p">)</span>
        <span class="c">#ras = re.compile(&#39;Fabric has&#39;)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="n">ras_result</span> <span class="o">=</span> <span class="s">&quot;0&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ras_result</span> <span class="o">=</span> <span class="n">ras_result_all</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">ras_result_all</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ras_result</span>
    
    </div>
<div class="viewcode-block" id="FabricInfo.ipv4_list"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.ipv4_list">[docs]</a>    <span class="k">def</span> <span class="nf">ipv4_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string of the ipv4 address of the switches in</span>
<span class="sd">            the current fabric</span>
<span class="sd">            Return none if nothing is matched</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__change_fid__</span><span class="p">()</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fabricshow&quot;</span><span class="p">)</span>
        <span class="c">#### the next two lines would return each item from the fabricshow command</span>
        <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3}):\s+([\d\w]{6})\s+([:\d\w]{23})\s+([.\d]{7,15})\s+([.\d]{7,15})\s+([&quot;_\w\d]+)&#39;)</span>
        <span class="c">#ras_result = ras.search(capture_cmd)</span>
        <span class="c">#### the above two lines not used here</span>
        
        <span class="c">### if used with the above line the next regex would return all the ipv4</span>
        <span class="c">####  addresses  but with FCR there are 00.00.00.00 addresses these are not</span>
        <span class="c">####   included with the current regex</span>
        <span class="c">#ras = re.compile(&#39;\s+([.\d]{7,15})\s+&#39;)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\s?[0-9]{1,3}:\s+[\d\w]{6}\s+[:\d\w]{23}\s+)([1-9][0-90-9].\d{1,3}.\d{1,3}.\d{1,3})&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="n">ras_result_all</span><span class="p">)</span>
            
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="n">ras_result_all</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span>
           
        <span class="k">return</span> <span class="n">ras_result_all</span>
    
    </div>
<div class="viewcode-block" id="FabricInfo.ipv4_plus_fcr_list"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.ipv4_plus_fcr_list">[docs]</a>    <span class="k">def</span> <span class="nf">ipv4_plus_fcr_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pa</span><span class="p">,</span><span class="n">pw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string of the ipv4 plus switches attached via FCR</span>
<span class="sd">            Return none if nothing is matched with ipv4_list</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fablist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span>
        <span class="n">fablist_extended</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">fablist_nodup</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#print(&quot;\n\n\n\n\nFABLIST IS AT THE START  &quot;, fablist, &quot;\n\n\n\n\n&quot;)</span>
        <span class="n">fablist_base</span> <span class="o">=</span> <span class="n">fablist</span>
        <span class="c">#for f in fablist_base:</span>
        <span class="c">#print(&quot;\n\n\n\n\nFCR FAB BASE LIST   &quot;, fablist_base, &quot;\n\n\n\n&quot;)</span>
        <span class="n">conn_value</span> <span class="o">=</span> <span class="n">connect_tel</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span><span class="n">pw</span><span class="p">)</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fcrfabricshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\d{1,3}\s+\d{1,3}\s+)(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="c">#print(&quot;\n\n\n\n\nFCR FAB SHOW LIST   &quot;, ras_result_all, &quot;\n\n\n\n&quot;)</span>
        <span class="c">#print(&quot;\n\n\n\n\nFABLIST IS  :  &quot;, fablist, &quot;\n\n\n\n\n&quot;)</span>
        
        <span class="k">if</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">ras_result_all</span><span class="p">:</span>
                <span class="c">#print(&quot;\n\n\n\n\nCURRENTLY ON IP &quot;, ip , &quot;\n\n\n\n&quot;)</span>
                <span class="n">orig_ip</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">ip</span>
                <span class="n">pa</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span>
                <span class="n">conn_value</span> <span class="o">=</span> <span class="n">connect_tel</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span><span class="n">pw</span><span class="p">)</span>
                <span class="n">fablist_extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span>
                <span class="c">#close_tel()</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">fablist_extended</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fablist</span><span class="p">:</span>
                        <span class="n">fablist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">pa</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">orig_ip</span>
        <span class="c">#liabhar.cls()</span>
        <span class="c">#print(&quot;\n\n\nFABLIST \nList of IP in the Fabric :  &quot;)</span>
        <span class="c">#for ip in fablist:</span>
            <span class="c">#print(&quot;    %s&quot; % ip)</span>
        
        <span class="c">#liabhar.count_down(10)</span>
        
        <span class="k">return</span><span class="p">(</span><span class="n">fablist</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="FabricInfo.name"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.name">[docs]</a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string of the names of the members in the current fabric</span>
<span class="sd">            Return none if no match is found</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">__change_fid__</span><span class="p">()</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fabricshow&quot;</span><span class="p">)</span>
        
        <span class="c">#### the next two lines would return each item from the fabricshow command</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3}):\s+([\d\w]{6})\s+([:\d\w]{23})\s+([.\d]{7,15})\s+([.\d]{7,15})\s+([&quot;_\w\d]+)&#39;</span><span class="p">)</span>
        <span class="n">ras_result</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="c">#### the above two lines not used here</span>
        
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;[.\d]{7,15}\s+[.\d]{7,15}\s+&gt;?([&quot;_\w\d]+)&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="n">sw_names</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span>
            
        <span class="n">sw_names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras_result_all</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">sw_names</span>
     
     </div>
<div class="viewcode-block" id="FabricInfo.all_info"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.all_info">[docs]</a>    <span class="k">def</span> <span class="nf">all_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Does nothing at this time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
    </div>
<div class="viewcode-block" id="FabricInfo.fabric_members"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.fabric_members">[docs]</a>    <span class="k">def</span> <span class="nf">fabric_members</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string of the members of the current fabric</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fabricshow&quot;</span><span class="p">)</span>
        
        <span class="c">#15})\\s+(FC)\\s+([\(\)\&quot;:_ \-a-zA-Z0-9]+)&#39;)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3}):\s+([\d\w]{6})\s+([:\d\w]{23})\s+([.\d]{7,15})\s+([.\d]{7,15})\s+([&quot;_\w\d]+)&#39;</span><span class="p">)</span>
        <span class="n">ras_result</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3}):\s+&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
         
        <span class="c">#if ras_result:</span>
            <span class="c">#print(&quot;\n\nFabric show output\n&quot;)</span>
            <span class="c">#print(&quot;Match found group 0: &quot;,ras_result.group())</span>
            <span class="c">#print(&quot;Match found group 1: &quot;,ras_result.group(1))</span>
            <span class="c">#print(&quot;Match found group 2: &quot;,ras_result.group(2))</span>
            <span class="c">#print(&quot;Match found group 3: &quot;,ras_result.group(3))</span>
            <span class="c">#print(&quot;Match found group 4: &quot;,ras_result.group(4))</span>
            <span class="c">#print(&quot;Match found group 5: &quot;,ras_result.group(5))</span>
            <span class="c">#print(&quot;Match found group 6: &quot;,ras_result.group(6))</span>
            <span class="c">#print(&quot;Match found group 7: &quot;,ras_result.group(7))</span>
        
            <span class="c">#print(&quot;\n\nFabric show output end\n&quot;)</span>
        <span class="c">#else:</span>
            <span class="c">#ras_result = &quot;no fabric&quot;</span>
            <span class="c">#print(&quot;no fabric&quot;)</span>
            
        <span class="k">if</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="c">#print(&quot;\n\nFabric show output find ALL\n&quot;)</span>
            <span class="c">#print(&quot;Match for find all :&quot; , ras_result_all)</span>
            <span class="c">#swtch_one = ras_result_all[0]</span>
            <span class="c">#print(&quot;First in the list is : &quot;, swtch_one)</span>
            <span class="c">#how_many = len(ras_result_all)</span>
            <span class="c">#print(&quot;Last in the list is  : &quot;, ras_result_all[how_many -1])</span>
            
            <span class="c">#print(&quot;\n\nFabric show find all output end\n&quot;)</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras_result_all</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;NOOOOOOOOOOOOO!!!!!!!!!!&quot;</span><span class="p">)</span>
            <span class="n">ras_result</span> <span class="o">=</span> <span class="s">&quot;no fabric&quot;</span>
            <span class="k">return</span><span class="p">(</span><span class="s">&quot;no fabric&quot;</span><span class="p">)</span>
            
        <span class="k">return</span><span class="p">(</span><span class="n">ras_result</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="FabricInfo.zone_info"><a class="viewcode-back" href="../index.html#anturlar.FabricInfo.zone_info">[docs]</a>    <span class="k">def</span> <span class="nf">zone_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           return info all about the zones</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#### need to add zone names</span>
        
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;cfgshow&quot;</span><span class="p">)</span>
        <span class="c">#### find the effective config</span>
        <span class="c">#### cfgshow</span>
        <span class="c">####   The Fabric is busy, try again later.</span>
        <span class="c">#ras = re.compile(&#39;Effective configuration:\s+cfg:([_0-9A-Za-z])&#39;)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(Effective configuration):\s+</span><span class="se">\\</span><span class="s">n\s+cfg:\s([_A-Za-z0-9]+)(?=</span><span class="se">\\</span><span class="s">t)&#39;</span><span class="p">)</span>
        <span class="n">ras_result</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result</span><span class="p">:</span>
            <span class="n">r_list</span> <span class="o">=</span> <span class="s">&quot;NO Config Found&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span> <span class="n">ras_result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ras_result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
            <span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>
        <span class="k">return</span><span class="p">(</span><span class="n">r_list</span><span class="p">)</span>
        </div></div>
<div class="viewcode-block" id="SwitchInfo"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo">[docs]</a><span class="k">class</span> <span class="nc">SwitchInfo</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class to return information about a switch</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">tn</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#my_ipaddr = ipaddr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__director__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ipaddr</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__myIPaddr__</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">__sw_show_info_no_port_type__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            capture the switch info and each column with regexs</span>
<span class="sd">            if the port type is not included in switchshow output</span>
<span class="sd">            then add the port to the list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#tn.set_debuglevel(9)</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3})\s+([-\d]+)\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+((FC)\s*(?=</span><span class="se">\\</span><span class="s">n))&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+((FC)\s*(?=\\n))&#39;)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9a-f]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+((FC)\s*(?=</span><span class="se">\\</span><span class="s">n))&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span> <span class="o">=</span> <span class="n">ras</span>
        
    <span class="k">def</span> <span class="nf">__sw_show_info_all_ports__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            capture switchshow info for ports (port types: F,E,EX,VEX and Disabled) and each column with regex</span>
<span class="sd">            return the index list of ports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span> <span class="p">:</span>
            <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3})\s+([-\d]+)\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+(Online)\s+(FC)\s+([-&gt;\w]{6,8})\s+([()-:\&quot;_\w\s\d]*?(?=\\n))&#39;)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3})\s+([-\d]+)\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+([FCVE]+)\s*([-&gt;\w]{6,8})([()-:</span><span class="se">\&quot;</span><span class="s">_=\w\s\d]*?(?=</span><span class="se">\\</span><span class="s">n))&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+(Online)\s+[FCVE]\s+([-&gt;\w]{6,14})\s+([()-:\&quot;_\w\s\d]*?(?=\\n))&#39;)  </span>
            <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+(FC)\s+([-&gt;\w]{6,14})\s+([()-:\&quot;_\w\s\d]*?(?=\\n))&#39;)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+([FCVE]+)\s*([-&gt;\w]{6,14})([()-:</span><span class="se">\&quot;</span><span class="s">_=\w\s\d]*?(?=</span><span class="se">\\</span><span class="s">n))&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span> <span class="o">=</span> <span class="n">ras</span>
    
    <span class="k">def</span> <span class="nf">__director__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            determine if the switch is director or pizza box</span>
<span class="sd">            True = director</span>
<span class="sd">            False = pizza box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;hashow&quot;</span><span class="p">)</span>
        <span class="c">#print(&#39;ZZZZZZZZZZZ&#39;)</span>
        <span class="c">#print(capture_cmd)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="s">&quot;hashow: Not supported&quot;</span> <span class="ow">in</span> <span class="n">capture_cmd</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">__myIPaddr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            determine the current switch IP</span>
<span class="sd">            Return the ipv4 address</span>
<span class="sd">            Return 0 if no match found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;ipaddrshow&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c">#match = re.search(&#39;(?P&lt;ipaddress&gt;[\s+\S+]+:([\d\.]){7,15}(?=\\r\\n))&#39;, capture_cmd)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&#39;(?P&lt;pre&gt;([\s+\w+]+):\s?(?P&lt;ip&gt;[0-9\.]{1,15}))&#39;</span><span class="p">,</span> <span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">myip</span> <span class="o">=</span> <span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;ip&#39;</span><span class="p">))</span>
            <span class="k">return</span><span class="p">(</span><span class="n">myip</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s"> NO IP FOUND </span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getblanklist__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Find the ports that are blank </span>
<span class="sd">            Return a list of port or slot / port for directors            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#### this still needs tested for no port in the list</span>
        <span class="c">####  in other words with all ports populated</span>
        <span class="c">#### it could be tested with all SIM ports</span>
        <span class="c">####</span>
        <span class="n">port_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sw_show_info_no_port_type__</span><span class="p">()</span>
        <span class="n">capture_cmd_split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">capture_cmd_split</span><span class="p">:</span>
            <span class="n">slot_port_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">slot_port_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
                <span class="n">slot_port_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">port_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slot_port_list</span><span class="p">)</span>
         
        <span class="k">return</span><span class="p">(</span><span class="n">port_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getportlist__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">porttype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `   Return a list of the porttype passed in - in the current FID</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">port_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sw_show_info_all_ports__</span><span class="p">()</span>
        <span class="n">capture_cmd_split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span>
        <span class="n">ras_result</span> <span class="o">=</span> <span class="n">capture_cmd_split</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">porttype</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="mi">7</span>
            
        <span class="n">persist_local</span> <span class="o">=</span> <span class="n">location</span>
        <span class="n">persist_local</span> <span class="o">+=</span> <span class="mi">1</span>
            
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">capture_cmd_split</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="n">location</span><span class="p">]</span> <span class="o">==</span> <span class="n">porttype</span><span class="p">:</span>
                <span class="c">#### port_list.append(i[0])</span>
                <span class="c">#slot_port_list = []</span>
                <span class="c">#slot_port_list.append(int(i[1]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
                    <span class="c">#slot_port_list.append(int(i[2]))</span>
                    <span class="n">slot_port_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                <span class="c">#port_list.append(s_p)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">slot_port_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="n">port_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slot_port_list</span><span class="p">)</span>
                 
                 
            <span class="k">if</span> <span class="n">porttype</span> <span class="o">==</span> <span class="s">&quot;Persistent&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s">&quot;rsistent&quot;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="n">persist_local</span><span class="p">]:</span>
                        <span class="c">####port_list.append(i[0])</span>
                        <span class="c">#slot_port_list = []</span>
                        <span class="c">#slot_port_list.append(int(i[1]))</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
                            <span class="c">#slot_port_list.append(int(i[2]))</span>
                            <span class="n">slot_port_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">slot_port_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                        <span class="n">port_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slot_port_list</span><span class="p">)</span>
                        
                <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;unboundlocalerror - moving on  &quot;</span><span class="p">)</span>
                    <span class="k">pass</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result</span><span class="p">:</span>
            <span class="n">ras_result</span> <span class="o">=</span> <span class="s">&quot;no port found&quot;</span>
        <span class="k">return</span> <span class="n">port_list</span>
    
<div class="viewcode-block" id="SwitchInfo.all_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.all_ports">[docs]</a>    <span class="k">def</span> <span class="nf">all_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Queuries switch for number of ports.</span>
<span class="sd">            return the port list or none if no ports in the FID</span>
<span class="sd">            The list will include FC and VE ports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">ras_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\d{1,4}\s{3,4})(?P&lt;slotnumber&gt;\d{1,2})\s+?(?P&lt;port&gt;\d{1,2})&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras</span><span class="p">:</span>
                <span class="n">ras_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras_list</span><span class="p">:</span>
                <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:</span><span class="se">\n</span><span class="s">\s+?\d+\s{0,3})(\d{0,3})&#39;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras</span><span class="p">:</span>
                <span class="n">prt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                <span class="c">#prt.append(int(i))</span>
                <span class="n">ras_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
                 
            <span class="k">return</span><span class="p">(</span><span class="n">ras_list</span><span class="p">)</span>
        
        <span class="k">return</span><span class="p">(</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.all_ports_fc_only"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.all_ports_fc_only">[docs]</a>    <span class="k">def</span> <span class="nf">all_ports_fc_only</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Queuries switch for number of ports.</span>
<span class="sd">            return the port list or none if no ports in the FID</span>
<span class="sd">            the list will include FC ports only</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ras_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\d{1,4}\s{3,4})(?P&lt;slotnumber&gt;\d{1,2})\s+?(?P&lt;port&gt;\d{1,2})\s+[-0-9a-f]{6}\s+[-idcu]{2}\s+[-AN24816G]{2,3}\s+\w+\s+[FC]{2}&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras</span><span class="p">:</span>
                <span class="n">ras_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras_list</span><span class="p">:</span>
                <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?\d{1,2}\s+(\d{1,2})\s+[-0-9a-f]{6}\s+[-idcu]{2}\s+[-AN24816G]{2,3}\s+\w+\s+[FC]{2}&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras</span><span class="p">:</span>
                <span class="n">prt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                <span class="c">#prt.append(int(i))</span>
                <span class="n">ras_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
                 
            <span class="k">return</span><span class="p">(</span><span class="n">ras_list</span><span class="p">)</span>
        
        <span class="k">return</span><span class="p">(</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.base_check"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.base_check">[docs]</a>    <span class="k">def</span> <span class="nf">base_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return Base FID if found</span>
<span class="sd">            Return False if no base is found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;lscfg --show&quot;</span><span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&#39;(?P&lt;default&gt;\d{0,3})\(ds\)(?:.+?)(?P&lt;base&gt;\d{0,3})\(bs\)&#39;</span><span class="p">,</span> <span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
           <span class="n">base</span> <span class="o">=</span> <span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;base&#39;</span><span class="p">))</span>
           <span class="k">return</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
           <span class="k">return</span> <span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.blade_search_8GB"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.blade_search_8GB">[docs]</a>    <span class="k">def</span> <span class="nf">blade_search_8GB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parse out 8GB Blades.</span>
<span class="sd">            This is used against non-VF switches.</span>
<span class="sd">            Return 0 if none are found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#global tn</span>
        <span class="n">slotshow_8GB</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;slotshow -m | grep F.8&quot;</span><span class="p">)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;BLADE&quot;</span><span class="p">)</span>
        <span class="n">matchObj</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">slotshow_8GB</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">matchObj</span><span class="p">:</span>
            <span class="c">#print(&quot;\n\n\nGathering Blade Info\n\n\n&quot;)</span>
            <span class="k">return</span><span class="p">(</span><span class="n">slotshow_8GB</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.blades"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.blades">[docs]</a>    <span class="k">def</span> <span class="nf">blades</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            return the list of SW blades in the switch</span>
<span class="sd">            includes SW BLADES and AP BLADES</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;slotshow -m&quot;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(\d+)\s+(SW BLADE|AP BLADE)\s+(\d+)\s+([-FCOEX1032468]+)\s+(\w+)&#39;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s">&quot;not a director&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SwitchInfo.blank_type"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.blank_type">[docs]</a>    <span class="k">def</span> <span class="nf">blank_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of ports that do not have a port type</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getblanklist__</span><span class="p">())</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.currentFID"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.currentFID">[docs]</a>    <span class="k">def</span> <span class="nf">currentFID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return the current FID number</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;[.\s]+LS Attributes:\s+\[FID:\s+(\d+)&#39;</span><span class="p">)</span> 
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;CURRENT FID&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="s">&quot;AG MODE ?&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    </div>
    <span class="k">def</span> <span class="nf">chassisname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;chassisname&quot;</span><span class="p">)</span>
        <span class="n">cn</span> <span class="o">=</span> <span class="n">capture_cmd</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;([\w\d_]+)(?:</span><span class="se">\\</span><span class="s">r</span><span class="se">\\</span><span class="s">n)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">d_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            this does not work because the getportlist requires the port</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;D-Port&quot;</span><span class="p">))</span>
     
<div class="viewcode-block" id="SwitchInfo.default_switch"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.default_switch">[docs]</a>    <span class="k">def</span> <span class="nf">default_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return default FID if found</span>
<span class="sd">            Return 0 if no match</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;lscfg --show&quot;</span><span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&#39;(?P&lt;default&gt;\d{0,3})\(ds\)(?:.+?)(?P&lt;base&gt;\d{0,3})\(bs\)&#39;</span><span class="p">,</span> <span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;default&#39;</span><span class="p">))</span>
            <span class="k">return</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SwitchInfo.director"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.director">[docs]</a>    <span class="k">def</span> <span class="nf">director</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            return a 1 if this switch is a director</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.disabled_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.disabled_ports">[docs]</a>    <span class="k">def</span> <span class="nf">disabled_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of disabled ports including Persistent disabled ports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;Disabled&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.e_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.e_ports">[docs]</a>    <span class="k">def</span> <span class="nf">e_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `   Return a list of the E-ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doit</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;E-Port&quot;</span><span class="p">)</span>
        <span class="n">dex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dex</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">dex</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c">#if dex != -1:</span>
            <span class="c">#e.pop(dex)</span>
        
        <span class="k">return</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.ex_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.ex_ports">[docs]</a>    <span class="k">def</span> <span class="nf">ex_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `   Return a list of the EX-ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;EX-Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.vex_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.vex_ports">[docs]</a>    <span class="k">def</span> <span class="nf">vex_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `   Return a list of the VEX-ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;VEX-Port&quot;</span><span class="p">))</span>
      </div>
<div class="viewcode-block" id="SwitchInfo.d_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.d_ports">[docs]</a>    <span class="k">def</span> <span class="nf">d_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the D-Ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;D-Port&quot;</span><span class="p">))</span>
        </div>
<div class="viewcode-block" id="SwitchInfo.f_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.f_ports">[docs]</a>    <span class="k">def</span> <span class="nf">f_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `   Return a list of the F-ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;F-Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.fan_count"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.fan_count">[docs]</a>    <span class="k">def</span> <span class="nf">fan_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            count the list of fans returned in fanshow command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fanshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(Fan)\s(\d)([, \w\d]{9,25})&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.fcr_enabled"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.fcr_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">fcr_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Determine if FCR is enabled on the switch</span>
<span class="sd">            1 - yes</span>
<span class="sd">            0 - no</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fos_cfg</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fosconfig --show&quot;</span><span class="p">)</span>
        <span class="n">foscfg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="s">r&#39;(FC Routing service:).*(enabled)&#39;</span><span class="p">,</span> <span class="n">fos_cfg</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="o">|</span><span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">foscfg</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>    
     </div>
<div class="viewcode-block" id="SwitchInfo.g_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.g_ports">[docs]</a>    <span class="k">def</span> <span class="nf">g_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the G-ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;G-Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.getLicense"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.getLicense">[docs]</a>    <span class="k">def</span> <span class="nf">getLicense</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            get a list of the license on the switch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;licenseshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;([\w\d]{16,37})(?=:</span><span class="se">\\</span><span class="s">r</span><span class="se">\\</span><span class="s">n)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    </div>
    <span class="k">def</span> <span class="nf">ipaddress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__myIPaddr__</span><span class="p">())</span>
    
<div class="viewcode-block" id="SwitchInfo.loopback"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.loopback">[docs]</a>    <span class="k">def</span> <span class="nf">loopback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the Loopback-ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;Loopback-&gt;Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.ls"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.ls">[docs]</a>    <span class="k">def</span> <span class="nf">ls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            find the logical switch numbers and return them in a list </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;lscfg --show&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(\d{1,3})(?=\()&#39;</span><span class="p">)</span>  
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.ls_now"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.ls_now">[docs]</a>    <span class="k">def</span> <span class="nf">ls_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            find the logical switch numbers that is currently logged in </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;[-_A-Za-z0-9]{1,30}:FID(\d{1,3})&#39;</span><span class="p">)</span>  
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SwitchInfo.n_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.n_ports">[docs]</a>    <span class="k">def</span> <span class="nf">n_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of N-Ports in the current FID</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;N-Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.persistent_disabled_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.persistent_disabled_ports">[docs]</a>    <span class="k">def</span> <span class="nf">persistent_disabled_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of disabled ports including Persistent disabled ports</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;Persistent&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="SwitchInfo.sensor_t_f_ps"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.sensor_t_f_ps">[docs]</a>    <span class="k">def</span> <span class="nf">sensor_t_f_ps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sensor_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of temp sensors, Fan or Power Supply from</span>
<span class="sd">            sensorshow commmand that report Ok</span>
<span class="sd">            type can be f = Fan    t = Temperature Sensor   ps = Power Supply</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s">&quot;t&quot;</span><span class="p">:</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;sensorshow&quot;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(sensor)\s+(\d+):\s+\((Temperature)\)\s+is\s+([Ok]{2}), value is (\d+)&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
         
        <span class="k">if</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s">&quot;f&quot;</span><span class="p">:</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;sensorshow&quot;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(sensor)\s+(\d+):\s+\((Fan        )\)\s+is\s+([OkFaulty]{2,6})(?=,speed is (\d+))*&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
         
        <span class="k">if</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s">&quot;ps&quot;</span><span class="p">:</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;sensorshow&quot;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(sensor)\s+(\d+):\s+\((Power Supply)\)\s+is\s+([Ok]{2})&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SwitchInfo.sfp_info"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.sfp_info">[docs]</a>    <span class="k">def</span> <span class="nf">sfp_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">info_type</span><span class="o">=</span><span class="s">&quot;info&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of sfp and the optic speed</span>
<span class="sd">            speed or a summary</span>
<span class="sd">            pass summary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c">#### director data</span>
        <span class="n">sfpinfo</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sfp_combine</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_ports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ports_fc_only</span><span class="p">()</span>
        <span class="n">sfp_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count16</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count8</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count4</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count10</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count_other</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#print(&quot;\n\n\n\n&quot;)</span>
        <span class="c">#print(all_ports)</span>
        <span class="c">#print(&quot;@&quot;*80)</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_ports</span><span class="p">:</span>
            
            <span class="n">slot</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;sfpshow </span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">slot</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(\d{1,2}(?=_G))&#39;</span><span class="p">)</span>
            <span class="c">#ras = re.compile(&#39;Transceiver:\s+[\d\w]{16}\s+[,\d]?(\d{1,2}(?=_))&#39;)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            <span class="n">sfp_speed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            
            <span class="c">#print(&quot;\n\n\n&quot;)</span>
            <span class="c">#print(ras)</span>
            <span class="c">#if ras != []:</span>
            <span class="c">#    print(&quot;EMPTYSET&quot;)</span>
            <span class="c">#print(&quot;\n\n\n\n&quot;)</span>
            
            <span class="k">if</span> <span class="n">ras</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="c">#print(&quot;\n\nSETTING THE SDFINFO info  \n&quot;)</span>
                <span class="c">#print(&quot;with slot port speed %s  %s   %s : &quot; % (slot, port, sfp_speed))</span>
                <span class="n">sfp_speed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">sfp_combine</span> <span class="o">=</span> <span class="p">[</span><span class="n">slot</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">sfp_speed</span><span class="p">]</span>
                <span class="n">sfpinfo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sfp_combine</span><span class="p">)</span>
                <span class="c">#print(&quot;\n\nSETTING THE SDFINFO info  \n&quot;)</span>
                <span class="c">#print(&quot;with slot port speed %s  %s   %s : &quot; % (slot, port, sfp_speed))</span>
                   
        <span class="n">sfp_combine</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sfpinfo</span><span class="p">:</span>
            <span class="n">sfp_count</span> <span class="o">+=</span> <span class="mi">1</span>            
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
                <span class="n">count16</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">count8</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">count4</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">count10</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">count_other</span> <span class="o">+=</span><span class="mi">1</span>
            
        <span class="n">sfpinfo_summary</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;total sfp count = &quot;</span><span class="p">,</span> <span class="n">sfp_count</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">count16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">count8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">count4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">count10</span><span class="p">,</span> <span class="s">&quot;other&quot;</span><span class="p">,</span> <span class="n">count_other</span><span class="p">]</span>
        
        
        
        
        <span class="c">#### return list or summary or details</span>
        <span class="c">#### sfpinfo is list    sfp_summary</span>
        <span class="k">if</span> <span class="n">info_type</span> <span class="o">==</span> <span class="s">&quot;summary&quot;</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">sfpinfo_summary</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">info_type</span> <span class="o">==</span> <span class="s">&quot;detail&quot;</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">sfpinfo_detail</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">sfpinfo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SwitchInfo.sim_ports"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.sim_ports">[docs]</a>    <span class="k">def</span> <span class="nf">sim_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the SIM ports in the current FID</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extend_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">index_address</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">extended</span> <span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;SIM-Port&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__sw_show_info_all_ports__</span><span class="p">()</span>
            
            <span class="n">location</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
                <span class="n">location</span> <span class="o">=</span> <span class="mi">3</span>
                
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span><span class="p">:</span>
               
                <span class="k">if</span> <span class="s">&#39;SIM-Port&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">index_address</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">index_address</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">location</span><span class="p">])</span>
                    <span class="n">extend_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index_address</span><span class="p">)</span>
                    <span class="n">index_address</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">return</span><span class="p">(</span><span class="n">extend_list</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.switch_state"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.switch_state">[docs]</a>    <span class="k">def</span> <span class="nf">switch_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return the switch state &#39;Offline or Online&#39;</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;switchState:\s+(\w{6,7})&#39;</span><span class="p">)</span> 
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>     
    </div>
<div class="viewcode-block" id="SwitchInfo.switch_id"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.switch_id">[docs]</a>    <span class="k">def</span> <span class="nf">switch_id</span><span class="p">(</span><span class="bp">self</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           get the current switch</span>
<span class="sd">           does not work on AG switch</span>
<span class="sd">           </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#### need a check for AG switch </span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;switchDomain:\s+(\d{1,3})&#39;</span><span class="p">)</span> 
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ras</span><span class="p">]</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>     
    </div>
<div class="viewcode-block" id="SwitchInfo.switch_name"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.switch_name">[docs]</a>    <span class="k">def</span> <span class="nf">switch_name</span><span class="p">(</span><span class="bp">self</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           get the current switch Name from switchshow</span>
<span class="sd">           return the current switchname</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;switchName:\s+([_\d\w]{1,30})&#39;</span><span class="p">)</span> 
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="n">sn</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.synchronized"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.synchronized">[docs]</a>    <span class="k">def</span> <span class="nf">synchronized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            determine if a switch CP blades are in sync</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;hashow&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&quot;HA State synchronized&quot;</span> <span class="ow">in</span> <span class="n">capture_cmd</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.temp_sensors"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.temp_sensors">[docs]</a>    <span class="k">def</span> <span class="nf">temp_sensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absent</span><span class="o">=</span><span class="s">&#39;no&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            find the tempsensors with OK state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;tempshow&quot;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?(\d+)\s+(\d+)\s+(Ok)\s+(\d+)\s+(\d+)&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">absent</span> <span class="o">!=</span> <span class="s">&quot;no&quot;</span><span class="p">:</span>
                <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;tempshow&quot;</span><span class="p">)</span>
                <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?(\d+)\s+(\d+)\s+(Absent)\s+(\d+)\s+(\d+)&#39;</span><span class="p">)</span> 
                <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;tempshow&quot;</span><span class="p">)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?(\d+)\s+(Ok)\s+(\d+)\s+(\d+)&#39;</span><span class="p">)</span> 
            <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">absent</span> <span class="o">!=</span> <span class="s">&quot;no&quot;</span><span class="p">:</span>
                <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;tempshow&quot;</span><span class="p">)</span>
                <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?(\d+)\s+(Absent)\s+(\d+)\s+(\d+)&#39;</span><span class="p">)</span> 
                <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
            
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="SwitchInfo.vf_enabled"><a class="viewcode-back" href="../index.html#anturlar.SwitchInfo.vf_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">vf_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            See if switch has vf enabled</span>
<span class="sd">            Return VF or noVF</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#self.__change_fid__()</span>
        <span class="c">#self.lscfgshow = lscfgshow</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;lscfg --show&quot;</span> <span class="p">)</span>
        <span class="n">foscfg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="s">&#39;(requires)&#39;</span><span class="p">,</span> <span class="n">capture_cmd</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="o">|</span><span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">foscfg</span><span class="p">:</span>
            <span class="c">#print(&quot;\n\n\nVF not enabled on this switch\n\n\n&quot;)</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#print(&quot;\n\n\nVF is enabled on this switch\n\n\n&quot;)</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="FcrInfo"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo">[docs]</a><span class="k">class</span> <span class="nc">FcrInfo</span><span class="p">(</span><span class="n">FabricInfo</span><span class="p">,</span> <span class="n">SwitchInfo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for FCR functions and information. Doc strings need to be added for some of the functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">SwitchInfo</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">FabricInfo</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="FcrInfo.all_ex_ports"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.all_ex_ports">[docs]</a>    <span class="k">def</span> <span class="nf">all_ex_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Capture all ex ports for both Chassis and Pizza Box using &quot;switchshow&quot; command </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;EX-Port&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="FcrInfo.all_switches_in_bb_ip"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.all_switches_in_bb_ip">[docs]</a>    <span class="k">def</span> <span class="nf">all_switches_in_bb_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Returns ip addresses of all switches in backbone fabric. Does not get edge switches.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="n">backbone_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcr_backbone_ip</span><span class="p">()</span>
        <span class="k">return</span><span class="p">(</span><span class="n">backbone_ip</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="FcrInfo.ex_deconfig"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.ex_deconfig">[docs]</a>    <span class="k">def</span> <span class="nf">ex_deconfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find all EX-Ports AND VEX-Ports on either director or pizzabox and deconfigure.   </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchdisable&quot;</span><span class="p">)</span>
        <span class="n">portlist</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">all_ports</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">portlist</span><span class="p">:</span>
                <span class="n">slot</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;(?:\EX\sPort\s+)(?P&lt;state&gt; ON)&#39;</span><span class="p">)</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgshow %a/%a&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
                <span class="n">ex</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ex</span><span class="p">:</span>
                    <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgexport </span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="s">&quot;-a2&quot;</span><span class="p">))</span>
                    <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgvexport </span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="s">&quot;-a2&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">portlist</span><span class="p">:</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;(?:\EX\sPort\s+)(?P&lt;state&gt; ON)&#39;</span><span class="p">)</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgshow %a&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">ex</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ex</span><span class="p">:</span>
                    <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgexport &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot; -a2&quot;</span><span class="p">)</span>
                    <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgvexport &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot; -a2&quot;</span><span class="p">)</span>
        <span class="n">cmd_cap</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchenable&quot;</span><span class="p">)</span>        
        <span class="k">return</span><span class="p">(</span><span class="n">cmd_cap</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="FcrInfo.fcr_backbone_ip"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.fcr_backbone_ip">[docs]</a>    <span class="k">def</span> <span class="nf">fcr_backbone_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs fabricshow against backbone switches in a fabric to determine all IPs </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fcrcfg</span> <span class="o">=</span> <span class="n">FcrInfo</span><span class="p">()</span>
        <span class="n">fcrstatus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sw_basic_info</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;FCRSTATUS&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">fcrstatus</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fcrstatus</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>  <span class="c"># Test if base config&#39;d and if so</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">fcrcfg</span><span class="o">.</span><span class="n">base_check</span><span class="p">()</span> <span class="c"># get the base FID number</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">FabricInfo</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="c">###########NEW OBJECT FOR BASE FID</span>
            <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span> <span class="c">###########NEW OBJECT FOR BASE FID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="n">fcrcfg</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span>
        <span class="k">return</span><span class="p">(</span><span class="n">get_fabric_ip</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FcrInfo.fcr_fab_wide_ip"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.fcr_fab_wide_ip">[docs]</a>    <span class="k">def</span> <span class="nf">fcr_fab_wide_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Runs fcrfabricshow and fabricshow against switches in a backbone fabric to determine all IPs then</span>
<span class="sd">            removes any duplicate entries.</span>
<span class="sd">            This includes both backbone and edge switches and any additional switches resident in edge fabrics.</span>
<span class="sd">            Return is a set of IPs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
         
        <span class="n">fcrcfg</span> <span class="o">=</span> <span class="n">FcrInfo</span><span class="p">()</span>
        <span class="n">fcrstatus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sw_basic_info</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">fcrstatus</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>  <span class="c"># Test if base config&#39;d and if so</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">fcrcfg</span><span class="o">.</span><span class="n">base_check</span><span class="p">()</span> <span class="c"># get the base FID number</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">FabricInfo</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="c">###########NEW OBJECT FOR BASE FID</span>
            <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span> <span class="c">###########NEW OBJECT FOR BASE FID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="n">fcrcfg</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span>
        <span class="n">get_fcr_fabric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipv4_fcr</span><span class="p">()</span>
        <span class="n">fcr_fab_ip_list</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">get_fabric_ip</span> <span class="o">+</span> <span class="n">get_fcr_fabric</span><span class="p">))</span>
        
        <span class="n">all_ips</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">fcr_fab_ip_list</span><span class="p">:</span>
            <span class="n">connect_tel_noparse</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="s">&#39;root&#39;</span><span class="p">,</span><span class="s">&#39;password&#39;</span><span class="p">)</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">fcrcfg</span><span class="o">.</span><span class="n">base_check</span><span class="p">()</span> <span class="c"># get the base FID number</span>
            <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">FabricInfo</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="c">###########NEW OBJECT FOR BASE FID</span>
                <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span> <span class="c">###########NEW OBJECT FOR BASE FID</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">get_fabric_ip</span> <span class="o">=</span> <span class="n">fcrcfg</span><span class="o">.</span><span class="n">ipv4_list</span><span class="p">()</span>
                <span class="n">all_ips</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_fabric_ip</span><span class="p">)</span>
        <span class="n">all_ips_no_dups</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_ips</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="n">all_ips_no_dups</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FcrInfo.fcr_proxy_dev"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.fcr_proxy_dev">[docs]</a>    <span class="k">def</span> <span class="nf">fcr_proxy_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get number of proxy devices reported by switch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_check</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;setcontext &quot;</span> <span class="o">+</span> <span class="n">base</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">cmd_capture</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fcrproxydevshow | grep device&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cmd_capture</span><span class="p">)</span>
        <span class="n">device_number</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;:\s([0-9]{1,4})&#39;</span><span class="p">,</span> <span class="n">cmd_capture</span><span class="p">)</span>
        <span class="c">#print(&#39;DEVICEDEVICEDEVICE&#39;)</span>
        <span class="c">#print(device_number)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">device_number</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="FcrInfo.get_licenses"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.get_licenses">[docs]</a>    <span class="k">def</span> <span class="nf">get_licenses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query all switches in both bacakbone and edges, capture &quot;licenseshow&quot; command</span>
<span class="sd">        and write licenses to a file in /home/RunFromHere/logs/Switch_Licenses/&lt;switchname&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ip_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcr_fab_wide_ip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">ip_list</span><span class="p">:</span>
            <span class="n">connect_tel_noparse</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="s">&#39;root&#39;</span><span class="p">,</span><span class="s">&#39;password&#39;</span><span class="p">)</span>
            <span class="n">sw_info</span> <span class="o">=</span> <span class="n">SwitchInfo</span><span class="p">()</span>
            <span class="n">sw_name</span> <span class="o">=</span> <span class="n">sw_info</span><span class="o">.</span><span class="n">switch_name</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s%s%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="s">&quot;logs/Switch_Licenses/License_File_&quot;</span><span class="p">,</span> <span class="n">sw_name</span> <span class="p">,</span><span class="s">&quot;.txt&quot;</span><span class="p">)</span>
            <span class="n">ff</span> <span class="o">=</span> <span class="n">liabhar</span><span class="o">.</span><span class="n">FileStuff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="s">&#39;a+b&#39;</span><span class="p">)</span> <span class="c">###open new file or clobber old</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s%s%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">LICENSE FILE </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ip</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">,</span> <span class="n">sw_name</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">==============================</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">cons_out</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;licenseshow&quot;</span><span class="p">)</span>
            <span class="n">ff</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="n">ff</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cons_out</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">ff</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="FcrInfo.sw_basic_info"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.sw_basic_info">[docs]</a>    <span class="k">def</span> <span class="nf">sw_basic_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Retrieve FCR fabric and return info. Variable #&#39;s:</span>
<span class="sd">            0) Switch name</span>
<span class="sd">            1) IP address</span>
<span class="sd">            2) Chassis or Pizza Box</span>
<span class="sd">            3) VF or not</span>
<span class="sd">            4) FCR Enabled</span>
<span class="sd">            5) Base Configured</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">switchname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">switch_name</span><span class="p">()</span>
        <span class="n">ip_addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipaddress</span><span class="p">()</span>
        <span class="n">director</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">director</span><span class="p">()</span>
        <span class="n">vf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_enabled</span><span class="p">()</span>
        <span class="n">fcr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcr_enabled</span><span class="p">()</span>
        <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_check</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="p">[</span><span class="n">switchname</span><span class="p">,</span> <span class="n">ip_addr</span><span class="p">,</span> <span class="n">director</span><span class="p">,</span> <span class="n">vf</span><span class="p">,</span> <span class="n">fcr</span><span class="p">,</span> <span class="n">base</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="FcrInfo.ipv4_fcr"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.ipv4_fcr">[docs]</a>    <span class="k">def</span> <span class="nf">ipv4_fcr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string (list) ipv4 address of switch\switches connected</span>
<span class="sd">            to FCR Router thru EX-Port</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#self.__change_fid__()</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fcrfabricshow&quot;</span><span class="p">)</span>
        
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\d{1,3}\s+\d{1,3}\s+)(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="n">ras_result_all</span> <span class="o">=</span> <span class="bp">None</span> 
        <span class="k">return</span> <span class="n">ras_result_all</span>
</div>
<div class="viewcode-block" id="FcrInfo.ipv4_fid_export_fcr"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.ipv4_fid_export_fcr">[docs]</a>    <span class="k">def</span> <span class="nf">ipv4_fid_export_fcr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string (list) containing EX-Port number, FID and ipv4 address of switch\switches connected</span>
<span class="sd">            to FCR Router thru EX-Port</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#self.__change_fid__()</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;fcrfabricshow&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(\d{1,3})\s+(\d{1,3})\s+(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})&#39;</span><span class="p">)</span>
        <span class="n">ras_result_all</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras_result_all</span><span class="p">:</span>
            <span class="n">ras_result_all</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">ras_result_all</span> 
</div>
<div class="viewcode-block" id="FcrInfo.portcfgfillword"><a class="viewcode-back" href="../index.html#anturlar.FcrInfo.portcfgfillword">[docs]</a>    <span class="k">def</span> <span class="nf">portcfgfillword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfgvalue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            NOT WORKING. NEED TO FIGURE OUT HOW TO PASS IN CFGVALUE. applies user chosen setting (0-4) for portcfgfillword command.</span>
<span class="sd">            Will try against all ports in given fid/switch with FOS rejecting</span>
<span class="sd">            all but C2 (8GB) ports.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchdisable&quot;</span><span class="p">)</span>
        <span class="n">portlist</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">all_ports</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
           <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">portlist</span><span class="p">:</span>
                <span class="n">slot</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgfillword &quot;</span><span class="o">+</span><span class="n">slot</span><span class="o">+</span><span class="s">&quot;/&quot;</span><span class="o">+</span><span class="n">port</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span> <span class="n">cfgvalue</span> <span class="p">)</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">portlist</span><span class="p">:</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;portcfgfillword &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span> <span class="n">cfgvalue</span> <span class="p">)</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">cmd_cap</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchenable&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">cmd_cap</span><span class="p">)</span>
        </div></div>
<div class="viewcode-block" id="FcipInfo"><a class="viewcode-back" href="../index.html#anturlar.FcipInfo">[docs]</a><span class="k">class</span> <span class="nc">FcipInfo</span><span class="p">(</span><span class="n">FabricInfo</span><span class="p">,</span> <span class="n">SwitchInfo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class to return information about a switch</span>
<span class="sd">    Class for FCIP functions and information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#global tn</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">SwitchInfo</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">FabricInfo</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__sw_show_info_ge_port_type__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            capture the switch info and each column with regexs</span>
<span class="sd">            if the port type is not included in switchshow output</span>
<span class="sd">            then add the port to the list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#tn.set_debuglevel(9)</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3})\s+([-\d]+)\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+((FC)\s*(?=</span><span class="se">\\</span><span class="s">n))&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#ras = re.compile(&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9abcdef]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+((FC)\s*(?=\\n))&#39;)</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s?([0-9]{1,3})\s+(\d+)\s+([-0-9a-f]{6})\s+([-id]{2})\s+([-UNG12486]{2,3})\s+([_\w]{5,9})\s+((FC)\s*(?=</span><span class="se">\\</span><span class="s">n))&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span> <span class="o">=</span> <span class="n">ras</span>
 
<div class="viewcode-block" id="FcipInfo.all_ge_ports"><a class="viewcode-back" href="../index.html#anturlar.FcipInfo.all_ge_ports">[docs]</a>    <span class="k">def</span> <span class="nf">all_ge_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Capture all ge and xge ports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow | grep -i ge&quot;</span><span class="p">)</span>
        <span class="c">#a = self.__getportlist__(&quot;ge-port&quot;)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span> <span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\s+([0-9]{1,2})\s{1,2})([xge]{1,3}\d{1,2})\s+id\s+([0-4]{1,2}G)\s+([_\w]{5,9})\s+FCIP&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?:\s+)([xge]{1,3}\d{1,2})\s+[id-]{1,2}\s+([0-4]{1,2}G)\s+([_\w]{5,9})\s+FCIP&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;EX-Port&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    

        <span class="c">#for i in ras:</span>
        <span class="c">#    print(i)</span>
        <span class="c">#    sys.exit(0)</span>
        <span class="c">#    if self.am_i_director:</span>
        <span class="c">#        #slot_port_list.append(int(i[2]))</span>
        <span class="c">#        slot_port_list = [int(i[1]), int(i[2])]</span>
        <span class="c">#        #port_list.append(s_p)</span>
        <span class="c">#    else:</span>
        <span class="c">#        slot_port_list = [0, int(i[1])]</span>
        <span class="c">#        #port_list.append(slot_port_list) </span>
        <span class="c">#print(slot_port_list)</span>
    </div>
<div class="viewcode-block" id="FcipInfo.all_ge_port_disabled"><a class="viewcode-back" href="../index.html#anturlar.FcipInfo.all_ge_port_disabled">[docs]</a>    <span class="k">def</span> <span class="nf">all_ge_port_disabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Capture all disabled ge and xge ports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;switchshow | grep -i ge&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\s+(([0-9]{1,2}))(\s{1,2}[xge]{1,3}\d{1,2})\s+id\s+[0-4]{1,2}G\s+([_\w]{5,9})\s+FCIP&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(\s+[xge]{1,3}\d{1,2})\s+id\s+[0-4]{1,2}G\s+([_\w]{5,9})\s+FCIP&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">online_ports</span> <span class="o">=</span> <span class="n">ras</span>
        </div>
<div class="viewcode-block" id="FcipInfo.vex_ports"><a class="viewcode-back" href="../index.html#anturlar.FcipInfo.vex_ports">[docs]</a>    <span class="k">def</span> <span class="nf">vex_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the VEX-Ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;VEX-Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="FcipInfo.ex_ports"><a class="viewcode-back" href="../index.html#anturlar.FcipInfo.ex_ports">[docs]</a>    <span class="k">def</span> <span class="nf">ex_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the EX-Ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;EX-Port&quot;</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="FcipInfo.ge_ports"><a class="viewcode-back" href="../index.html#anturlar.FcipInfo.ge_ports">[docs]</a>    <span class="k">def</span> <span class="nf">ge_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a list of the ge-Ports in the current FID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getportlist__</span><span class="p">(</span><span class="s">&quot;ge-Port&quot;</span><span class="p">))</span>
        </div></div>
<span class="k">class</span> <span class="nc">configSwitch</span><span class="p">(</span><span class="n">SwitchInfo</span><span class="p">):</span>
    
    
    
    <span class="k">def</span> <span class="nf">getLsPorts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rasfile</span> <span class="o">=</span> <span class="s">&quot;configofswitch&quot;</span>
        <span class="n">rasfile</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;logs/configofswitch&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipaddr</span><span class="p">,</span><span class="s">&quot;.txt&quot;</span><span class="p">)</span>  <span class="c">#### %s string  %d number</span>
     
        <span class="n">sw_license</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLicense</span><span class="p">())</span>
        <span class="n">sw_license</span> <span class="o">=</span> <span class="n">sw_license</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="n">sw_ls_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
        <span class="n">sw_ls</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sw_ls_list</span><span class="p">)</span>
        <span class="n">sw_ls</span> <span class="o">=</span> <span class="n">sw_ls</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            
        <span class="n">ras_log_file</span> <span class="o">=</span> <span class="n">liabhar</span><span class="o">.</span><span class="n">FileStuff</span><span class="p">(</span><span class="n">rasfile</span><span class="p">,</span> <span class="s">&#39;w+b&#39;</span><span class="p">)</span>  <span class="c">#### reset the log file</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">ras_log_file</span> <span class="o">=</span> <span class="n">liabhar</span><span class="o">.</span><span class="n">FileStuff</span><span class="p">(</span><span class="n">rasfile</span><span class="p">,</span> <span class="s">&#39;a+b&#39;</span><span class="p">)</span>  <span class="c">#### open the log file for writing</span>
        <span class="n">ras_log_header</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;RASLOG CAPTURE FILE </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipaddr</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">==========================</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ras_log_header</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">LOGICAL SWITCHES::</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sw_ls</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">END</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">LOGICAL SWITCH PORTS::</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">get the list of ports</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">sw_ls_list</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">in the for loop &quot;</span><span class="o">+</span><span class="n">ls</span><span class="o">+</span><span class="s">&quot; </span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;setcontext </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span> <span class="n">ls</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ports</span><span class="p">()</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> : </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
        <span class="c">#ras_log_file.write(&quot;\n&quot;)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;END</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">LICENSE::</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sw_license</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;END</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">ras_log_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">saveSwitchInfo</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">getSwitchID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">switch_id</span><span class="p">())</span>
        
     
    <span class="k">def</span> <span class="nf">saveSwitchInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            get license info</span>
<span class="sd">            get ls info and base info</span>
<span class="sd">            get switchname info</span>
<span class="sd">            get switch id info</span>
<span class="sd">            </span>
<span class="sd">            save to config file logs/sqa_test_config.txt</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cw_config_file_name</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s%s%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="s">&quot;logs/configofswitch&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipaddr</span><span class="p">,</span><span class="s">&quot;.txt&quot;</span><span class="p">)</span>
        <span class="c">#rl = [] </span>
        <span class="n">fileIN</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">cw_config_file_name</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
        <span class="n">keepnext</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileIN</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;0000000000000000000000000000000000000000000000&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;11111111111111111111111111111111111111111111111&quot;</span><span class="p">)</span>
            <span class="n">liabhar</span><span class="o">.</span> <span class="n">count_down</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">line_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">remains_line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf8&#39;</span><span class="p">)</span>
            <span class="n">remains_line</span> <span class="o">=</span> <span class="n">remains_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;[&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">remains_line</span> <span class="o">=</span> <span class="n">remains_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;]&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">remains_line</span> <span class="o">=</span> <span class="n">remains_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">remains_line</span> <span class="o">=</span> <span class="n">remains_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s">&quot;END&quot;</span> <span class="ow">in</span> <span class="n">line_str</span><span class="p">:</span>
                <span class="n">keepnext</span> <span class="o">=</span> <span class="mi">0</span>   
                 
            <span class="k">if</span> <span class="n">keepnext</span><span class="p">:</span>
                <span class="n">rl</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;2222222222222222222222222222222222222222222222&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;do some setup here</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;split on , and print a digit&quot;</span><span class="p">)</span>
                 
                <span class="n">fid2</span> <span class="o">=</span> <span class="n">remains_line</span>
                <span class="n">fid2</span> <span class="o">=</span> <span class="n">fid2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span> 
                <span class="n">fid3</span> <span class="o">=</span> <span class="n">fid2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;FID3 IS  &quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">fid3</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;FID2 IS  &quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">fid2</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">fid4</span> <span class="o">=</span> <span class="n">fid2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">fid4</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fid4</span><span class="p">)</span>
                <span class="n">fid4</span> <span class="o">=</span> <span class="n">fid4</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
                <span class="c">#remains_line = remains_line.split(&quot;,&quot;)</span>
                
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fid4</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">rl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;==============================================&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rl</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;2222222222222222222222222222222222222222222222&quot;</span><span class="p">)</span>
                <span class="c">#### create slot port pair from the list </span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rl</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">rl</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
                        <span class="n">slot</span> <span class="o">=</span> <span class="n">rl</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                        <span class="n">port</span> <span class="o">=</span> <span class="n">rl</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">&quot;slot,port &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">slot</span><span class="o">+</span><span class="s">&quot;,&quot;</span><span class="o">+</span><span class="n">port</span><span class="p">)</span>
                
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;2222222222222222222222222222222222222222222222&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;2222222222222222222222222222222222222222222222&quot;</span><span class="p">)</span>
                
                
            <span class="k">if</span> <span class="s">&quot;LOGICAL SWITCH PORTS&quot;</span> <span class="ow">in</span> <span class="n">line_str</span><span class="p">:</span>
                <span class="n">keepnext</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;change keepnext to 1&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Maps</span><span class="p">(</span><span class="n">SwitchInfo</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">enable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span> <span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;echo Y | mapsconfig --enable -policy </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="n">policy</span><span class="p">))</span>
                
    <span class="k">def</span> <span class="nf">actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_list</span> <span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapsconfig --actions </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="n">action_list</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">email_cfg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email_list</span> <span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapsconfig --emailcfg -address </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="n">email_list</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapsrule --show -all&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(def[_ ,\/\()-=\.|&lt;&gt;A-Za-z0-9]+)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;[&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;]&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        

        
        
    <span class="k">def</span> <span class="nf">get_policies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span> <span class="p">):</span>
        <span class="c">#### ruturn the policy rules list for p</span>
        <span class="c">####  a = aggresive policy</span>
        <span class="c">####  c = conservative policy</span>
        <span class="c">####  m = moderate policy</span>
        <span class="c">####  s or none = summary of policy</span>
        
        <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s">&quot;s&quot;</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapspolicy --show -summary&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s">&quot;a&quot;</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapspolicy --show -dflt_aggressive_policy&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s">&quot;c&quot;</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapspolicy --show -dflt_conservative_policy&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s">&quot;m&quot;</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapspolicy --show -dflt_moderate_policy&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s">&quot;Could not determine the type of policy&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_nondflt_policies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            get the policies in a list of the non default policies</span>
<span class="sd">            need to remove the default policies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapspolicy --show -summary&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;([_\w\d]+)\s+(?=:)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">ras</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="n">ras_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        <span class="n">ras_str</span> <span class="o">=</span> <span class="n">ras_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ras_str</span> <span class="o">=</span> <span class="n">ras_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;[&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ras_str</span> <span class="o">=</span> <span class="n">ras_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;]&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ras_str</span> <span class="o">=</span> <span class="n">ras_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ras_final</span> <span class="o">=</span> <span class="n">ras_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
        
        <span class="k">return</span><span class="p">(</span><span class="n">ras_final</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">db_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            send the mapsdb command and return search string line</span>
<span class="sd">            for a Rule_name and returns the info on the</span>
<span class="sd">            rest of the line</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;mapsdb --show details&quot;</span><span class="p">)</span>
        <span class="c">#### %s=Rule Name |Execution time|Object             | triggered value</span>
        <span class="n">repattern</span> <span class="o">=</span> <span class="s">&quot;(</span><span class="si">%s</span><span class="s">)([ |/:\d]+(?=|))([ \w\d\s</span><span class="se">\\</span><span class="s">t]+)(?=|)([ \w\d\s</span><span class="se">\\</span><span class="s">t</span><span class="si">%s</span><span class="s">]+(?=|))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s">&quot;%&quot;</span><span class="p">)</span>
        <span class="n">repattern</span> <span class="o">=</span> <span class="s">&quot;(</span><span class="si">%s</span><span class="s">)([ |/:\d]+(?=|))([ \w\d\s</span><span class="se">\\</span><span class="s">t]+)(?=|)(.+)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        
        
        <span class="c">#ras = re.compile(&#39;(%s)[ |/:\d]+(?=|)([ \w\d\s|%]+)(?=\\n)&#39; % pattern)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;R&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;R&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">repattern</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;U&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;U&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">repattern</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        
        <span class="c">#output = ras.replace(&quot;|&quot;,&quot;&quot;)</span>
        <span class="c">#output = output.split(&quot; &quot;)</span>
        
        <span class="k">if</span> <span class="n">ras</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
            <span class="c">#return(output)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s">&quot;no match found&quot;</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">ras_message_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           search the errlog for a specific pattern</span>
<span class="sd">           </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;errdumpall&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">pattern</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n\n</span><span class="s">RAS PATTERN is  :  </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="n">pattern</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s"> </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="n">ras</span><span class="p">)</span>
         
        <span class="k">if</span> <span class="n">ras</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s">&quot;no match found&quot;</span><span class="p">)</span>
    
        <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
        
    <span class="k">def</span> <span class="nf">logicalgroup_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            return the count for the line group passed for any of the following</span>
<span class="sd">            </span>
<span class="sd">            ALL_PORTS</span>
<span class="sd">            ALL_F_PORTS         ALL_OTHER_F_PORTS       ALL_HOST_PORTS    </span>
<span class="sd">            ALL_TARGET_PORTS    ALL_TS                  ALL_FAN        </span>
<span class="sd">            ALL_PS              ALL_WWN                 ALL_SFP        </span>
<span class="sd">            ALL_10GSWL_SFP      ALL_10GLWL_SFP          ALL_16GSWL_SFP </span>
<span class="sd">            ALL_16GLWL_SFP      ALL_QSFP                ALL_OTHER_SFP  </span>
<span class="sd">            ALL_SLOTS           ALL_SW_BLADES           ALL_CORE_BLADES </span>
<span class="sd">            ALL_FLASH           ALL_CIRCUITS            SWITCH     </span>
<span class="sd">            CHASSIS             ALL_D_PORTS</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#### return a list of all the values ?</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;logicalgroup --show&quot;</span><span class="p">)</span>
            
        <span class="c">#ras = re.compile(&quot;(ALL_SW_BLADES)\s+(?:\|)(Yes)\s+\|(Blade)\s+(?:\|)([0-9])\s+(?:\|)([,0-9])&quot;)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;(</span><span class="si">%s</span><span class="s">)\s+\|Yes\s+\|[ \w]+\|([0-9]+)&quot;</span> <span class="o">%</span> <span class="n">group</span><span class="p">)</span>    
        <span class="c">#ras = ras.search(capture_cmd)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ras</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s">&quot;-1&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">THIS IS RAS  </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">THIS IS RAS GROUP </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                   
            <span class="n">value</span> <span class="o">=</span> <span class="n">ras</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cpu_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           calculate the cpu usage from the data</span>
<span class="sd">           in /proc/stat</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#### equation for cpu usage</span>
        <span class="c">#### cat /proc/stat - in the line containing cpu, the 4th number </span>
        <span class="c">####   is the idle time.  The CPU usage is calculated as</span>
        <span class="c">####  (100-(idle value at T1 - idle value at T2)*100/(sum of all number</span>
        <span class="c">####           at T1 - sum of all numbers at T2))</span>
        <span class="c">####</span>
        <span class="c">####    cat /proc/stat</span>
        <span class="c"># cpu  1296327 9539 459156 22597828 163062 9894 61210 0</span>
        <span class="c"># cpu0 1296327 9539 459156 22597828 163062 9894 61210 0</span>
        <span class="c"># intr 44837986softirq 65577794 148267 24596931 0 38492796 0 2339800</span>
        <span class="c">####</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;cat /proc/stat&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;^[ cpu]+([ \s\d]+)&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        
        <span class="n">cpu_calc</span> <span class="o">=</span> <span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">group</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">sumt1</span> <span class="o">=</span> <span class="p">(</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> \
                 <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>\
                 <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        <span class="n">liabhar</span><span class="o">.</span><span class="n">JustSleep</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;cat /proc/stat&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;^[ cpu]+([ \s\d]+)&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        
        <span class="n">cpu_calcT2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">group</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">sumt2</span> <span class="o">=</span> <span class="p">(</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  \
                 <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> \
                 <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> \
                 <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        
        <span class="c">#cpu_use = (100 - (((float(cpu_calc[4]) - float(cpu_calcT2[4]))*100)/(sumt1 - sumt2)))</span>
        <span class="n">cpu_use_n</span> <span class="o">=</span> <span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">cpu_calc</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">cpu_calcT2</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="o">*</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">cpu_use_d</span> <span class="o">=</span> <span class="p">(</span><span class="n">sumt1</span> <span class="o">-</span> <span class="n">sumt2</span><span class="p">)</span>
        <span class="n">cpu_use</span>  <span class="o">=</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="p">(</span> <span class="n">cpu_use_n</span> <span class="o">/</span> <span class="n">cpu_use_d</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> 
    
        <span class="k">return</span><span class="p">(</span><span class="n">cpu_use</span><span class="p">)</span>
    
    
    
    <span class="k">def</span> <span class="nf">temp_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           scan all the temp sensors and return the high temp, low temp</span>
<span class="sd">           and average temp of the switch using the tempshow command</span>
<span class="sd">           </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#capture_cmd = fos_cmd(&quot;tempshow&quot;)</span>
        <span class="c">#</span>
        <span class="c">#ras = re.compile(&quot;\d+\s+\w+\s+\d+\s+\d+&quot;)</span>
        <span class="c">#ras = ras.findall(capture_cmd)</span>
        <span class="c">#ras_str = str(ras)</span>
        <span class="c">#ras_str = ras_str.replace(&quot;\\t&quot;,&quot; &quot;)</span>
        <span class="c">#ras_str = ras_str.replace(&quot;&#39;&quot;, &quot;&quot;)</span>
        <span class="c">#ras_str = ras_str.replace(&quot;[&quot;, &quot;&quot;)</span>
        <span class="c">#ras_str = ras_str.replace(&quot;]&quot;, &quot;&quot;)</span>
        <span class="c">##ras_str = ras_str.replace(&quot; &quot;, &quot;&quot;)</span>
        <span class="c">#ras_final = &quot; &quot;.join(ras_str.split())</span>
        <span class="c">#</span>
        <span class="c">#ras_final = ras_final.split()</span>
        
        <span class="n">tempsensor_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensors</span><span class="p">()</span>
        
        <span class="n">highside</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">lowside</span> <span class="o">=</span> <span class="mi">999</span>
        <span class="n">average</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tempsensor_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">highside</span><span class="p">:</span>
                    <span class="n">highside</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> 
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">lowside</span><span class="p">:</span>
                    <span class="n">lowside</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tempsensor_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">highside</span><span class="p">:</span>
                    <span class="n">highside</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> 
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">lowside</span><span class="p">:</span>
                    <span class="n">lowside</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
             
        <span class="n">average</span> <span class="o">=</span> <span class="n">total</span> <span class="o">/</span> <span class="n">count</span>
        <span class="n">high_low_average</span> <span class="o">=</span> <span class="p">[</span> <span class="n">highside</span><span class="p">,</span> <span class="n">lowside</span><span class="p">,</span> <span class="n">average</span><span class="p">]</span>
        
        <span class="k">return</span><span class="p">(</span><span class="n">high_low_average</span><span class="p">)</span>
    
        
    <span class="k">def</span> <span class="nf">mem_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            calculate the memory usage from the data</span>
<span class="sd">            returned in the command free</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capture_cmd</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;free&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;[Mem:]{4}([ \s\d]+)&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">capture_cmd</span><span class="p">)</span>
        <span class="c">####  use the calculation (total - free - buffers - cached)/ total</span>
        <span class="c">####    ( 1024096 - 351328 - 40884 - 379300 ) / 1024096 = 25%</span>
        <span class="c">####</span>
        <span class="n">mem_calc</span> <span class="o">=</span> <span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">group</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">mem_use</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span><span class="n">mem_calc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">mem_calc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">mem_calc</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">mem_calc</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">mem_use</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">round</span><span class="p">(</span> <span class="n">mem_use</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">mem_calc</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))</span>
        
        <span class="k">return</span><span class="p">(</span><span class="n">mem_use</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">FlowV</span><span class="p">(</span><span class="n">SwitchInfo</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">genAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_off</span> <span class="o">=</span> <span class="s">&quot;on&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">on_off</span> <span class="o">==</span> <span class="s">&quot;on&quot;</span><span class="p">:</span>
            <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;flow --activate sys_gen_all_simports -fea gen&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">on_off</span> <span class="o">==</span> <span class="s">&quot;off&quot;</span><span class="p">:</span>
            <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;flow --deactivate sys_gen_all_simports -fea gen&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        
    <span class="k">def</span> <span class="nf">genAllStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cmd_out</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;flow --show sys_gen_all_simports&quot;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?&lt;=[:\s+])(\d+\.?\d+[GMTPk]?)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(?&lt;=[:\s+])(\d+[\.\dGMTPk]+)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">cmd_out</span><span class="p">)</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ras</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="n">s</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\t\t</span><span class="s">&quot;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">flow_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            get all the flow names return in a list</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_out</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;flow --show &quot;</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">cmd_out</span> <span class="p">,</span> <span class="s">&quot;</span><span class="se">\n\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="c">#ras = re.compile(&#39;([_-a-z0-9A-z]{1,20})[ \|]+[\*,-|a-zA-Z0-9]+(?=\n)&#39;)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">([_a-z0-9A-Z]{1,20})(?= |)&#39;</span><span class="p">)</span>
        <span class="n">ras</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">cmd_out</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">ras</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">simPorts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">return</span> <span class="mi">0</span> 
    
    
    <span class="k">def</span> <span class="nf">toggle_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_off</span> <span class="o">=</span> <span class="s">&quot;on&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            simport enable or disable</span>
<span class="sd">            default is to turn all ports to simports</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;-enable&quot;</span>
        <span class="k">if</span> <span class="n">on_off</span> <span class="o">==</span> <span class="s">&quot;off&quot;</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;-disable&quot;</span>
            
        <span class="n">portlist</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">all_ports</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_i_director</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">portlist</span><span class="p">:</span>
                <span class="n">slot</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="c">#pattern = re.compile(r&#39;(?:\Sim\sPort\s+)(?P&lt;state&gt; ON)&#39;)</span>
                <span class="c">#cmd = fos_cmd(&quot;portcfgshow %a/%a&quot; % (slot, port))</span>
                <span class="c">#ex = pattern.search(cmd)</span>
                <span class="c">#if ex:</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;flow --control -simport &quot;</span><span class="o">+</span><span class="n">slot</span><span class="o">+</span><span class="s">&quot;/&quot;</span><span class="o">+</span><span class="n">port</span><span class="o">+</span><span class="s">&quot; </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
              
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">portlist</span><span class="p">:</span>
                <span class="c">#pattern = re.compile(r&#39;(?:\Sim\sPort\s+)(?P&lt;state&gt; ON)&#39;)</span>
                <span class="c">#cmd = fos_cmd(&quot;portcfgshow %a&quot; % i)</span>
                <span class="c">#ex = pattern.search(cmd)</span>
                <span class="c">#if ex:</span>
                <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;flow --control -simport &quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot; </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
              
        <span class="k">return</span><span class="p">(</span><span class="n">portlist</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">pw</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
    <span class="n">pa</span> <span class="o">=</span> <span class="n">liabhar</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pw</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
        <span class="n">pw</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">()</span>
    <span class="n">conn_value</span> <span class="o">=</span> <span class="n">connect_tel</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span><span class="n">pw</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">conn_value</span>

<span class="k">def</span> <span class="nf">close_tel</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;exit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">tn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">0</span>
   
<span class="k">def</span> <span class="nf">connect_tel</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="n">pw</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fid</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">fid</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">verbose</span>
        <span class="n">HOST</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">ip</span>
        <span class="n">usrname</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">user</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">pw</span>
        
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrname</span> <span class="o">+</span> <span class="s">&#39;&gt; &#39;</span>
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrn</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="s">&quot;Login incorrect&quot;</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="n">bad_login</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot;hlogin: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;option :&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;root&gt;&quot;</span><span class="p">,</span> <span class="n">usrn</span><span class="p">,</span> <span class="n">telnet_closed</span><span class="p">,</span> <span class="n">bad_login</span> <span class="p">]</span>
        <span class="c">#print(HOST)</span>
        <span class="c">#print(usrname)</span>
        <span class="c">#print(password)</span>
        <span class="n">tn</span> <span class="o">=</span> <span class="n">telnetlib</span><span class="o">.</span><span class="n">Telnet</span><span class="p">(</span><span class="n">HOST</span><span class="p">)</span>
        <span class="c">#tn.set_debuglevel(9)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;login: &quot;</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">usrname</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">)</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">capture_t</span> <span class="o">=</span> <span class="n">capture</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">badlog0</span> <span class="o">=</span> <span class="n">capture_t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">badlog0</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Could not connect at this time&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Try again with a correct username / password combination&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">========================================================</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            
        
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>
        <span class="n">con_out</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">con_out</span> <span class="o">=</span> <span class="n">fos_cmd</span><span class="p">(</span><span class="s">&quot;setcontext </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">fid</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="n">con_out</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">capture</span>      
    
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">pass</span>
        
<span class="k">def</span> <span class="nf">connect_tel_noparse</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span><span class="n">usrname</span><span class="p">,</span><span class="n">password</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span>
        
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrname</span> <span class="o">+</span> <span class="s">&#39;&gt; &#39;</span>
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrn</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="s">&quot;Login incorrect&quot;</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="n">bad_login</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">traff_server</span> <span class="o">=</span> <span class="s">&quot; ~]# &quot;</span>
        <span class="c">#traff_prompt = &quot;----------&quot;</span>
        <span class="n">traff_prompt</span> <span class="o">=</span> <span class="s">&quot; ~]# &quot;</span>
        <span class="n">traff_server</span> <span class="o">=</span> <span class="n">traff_server</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot;hlogin: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;option :&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;root&gt;&quot;</span><span class="p">,</span> <span class="n">usrn</span><span class="p">,</span> <span class="n">telnet_closed</span><span class="p">,</span> <span class="n">bad_login</span><span class="p">,</span> <span class="n">traff_server</span> <span class="p">]</span>
        <span class="c">#print(HOST)</span>
        <span class="c">#print(usrname)</span>
        <span class="c">#print(password)</span>
        <span class="n">tn</span> <span class="o">=</span> <span class="n">telnetlib</span><span class="o">.</span><span class="n">Telnet</span><span class="p">(</span><span class="n">HOST</span><span class="p">)</span>
        <span class="c">#tn.set_debuglevel(9)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;login: &quot;</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">usrname</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">)</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">capture_t</span> <span class="o">=</span> <span class="n">capture</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">badlog0</span> <span class="o">=</span> <span class="n">capture_t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">badlog0</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Could not connect at this time&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Try again with a correct username / password combination&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">========================================================</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>      
    
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">pass</span>
    
<span class="k">def</span> <span class="nf">connect_tel_noparse_power</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span><span class="n">usrname</span><span class="p">,</span><span class="n">password</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span>
        
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrname</span> <span class="o">+</span> <span class="s">&#39;&gt; &#39;</span>
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrn</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="s">&quot;Login incorrect&quot;</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="n">bad_login</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot;cli-&gt;&quot;</span><span class="p">]</span><span class="c"># b&quot;Password: &quot;, b&quot;option :&quot;, b&quot;root&gt;&quot;, usrn, telnet_closed, bad_login, b&quot;cli-&gt;&quot; ]</span>
        <span class="c">#print(HOST)</span>
        <span class="c">#print(usrname)</span>
        <span class="c">#print(password)</span>
        <span class="n">tn</span> <span class="o">=</span> <span class="n">telnetlib</span><span class="o">.</span><span class="n">Telnet</span><span class="p">(</span><span class="n">HOST</span><span class="p">)</span>
        <span class="c">#tn.set_debuglevel(9)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;login: &quot;</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">usrname</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">)</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">)</span>
            <span class="n">capture_t</span> <span class="o">=</span> <span class="n">capture</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">badlog0</span> <span class="o">=</span> <span class="n">capture_t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">badlog0</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Could not connect at this time&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Try again with a correct username / password combination&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">========================================================</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">capture</span>      
    
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">pass</span>
 
<span class="k">def</span> <span class="nf">connect_tel_noparse_traffic</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span><span class="n">usrname</span><span class="p">,</span><span class="n">password</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span>
         
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrname</span> <span class="o">+</span> <span class="s">&#39;&gt; &#39;</span>
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrn</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="s">&quot;Login incorrect&quot;</span>
        <span class="n">bad_login</span> <span class="o">=</span> <span class="n">bad_login</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">traff_server</span> <span class="o">=</span> <span class="s">&quot; ~]# &quot;</span>
        <span class="c">#traff_prompt = &quot;----------&quot;</span>
        <span class="n">traff_prompt</span> <span class="o">=</span> <span class="s">&quot; ~]# &quot;</span>
        <span class="n">traff_server</span> <span class="o">=</span> <span class="n">traff_server</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot;hlogin: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;inistrator&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;assword: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;option :&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;root&gt;&quot;</span><span class="p">,</span> <span class="n">usrn</span><span class="p">,</span> <span class="n">telnet_closed</span><span class="p">,</span> <span class="n">bad_login</span><span class="p">,</span> <span class="n">traff_server</span> <span class="p">]</span>
        <span class="c">#print(HOST)</span>
        <span class="c">#print(usrname)</span>
        <span class="c">#print(password)</span>
        <span class="n">tn</span> <span class="o">=</span> <span class="n">telnetlib</span><span class="o">.</span><span class="n">Telnet</span><span class="p">(</span><span class="n">HOST</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;login: &quot;</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">usrname</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
            <span class="c">#print(&quot;looking for password here ::&quot;)</span>
            <span class="c">#tn.expect(reg_ex_list,10)</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;assword:&quot;</span><span class="p">)</span>
            <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">capture_t</span> <span class="o">=</span> <span class="n">capture</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">badlog0</span> <span class="o">=</span> <span class="n">capture_t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">badlog0</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Could not connect at this time&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Try again with a correct username / password combination&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">========================================================</span><span class="se">\n\n\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>      
    
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">pass</span>
    

<span class="k">def</span> <span class="nf">power_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">dl</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="c">#traff_prompt = &quot;\(yes, no\)  : &quot;</span>
        <span class="c">#traff_prompt = traff_prompt.encode()</span>
        
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot; cli-&gt;&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;\(yes, no\)  : &quot;</span><span class="p">,</span> <span class="n">telnet_closed</span><span class="p">]</span> <span class="c"># b&quot;Password: &quot;, b&quot;option :&quot;, b&quot;root&gt;&quot;, b&quot;Forcing Failover ...&quot;, usrn, telnet_closed ]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">capture</span>
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fos_cmd_regex</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span><span class="n">dblevel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
     <span class="c">###########################################################################</span>
    <span class="c">####   </span>
    <span class="c">####   to pass the reg make it a list and b style</span>
    <span class="c">####    reg_list = [b&#39;[my reg expression]&#39;, b&#39;second expression&#39; ]</span>
    <span class="c">####</span>
    <span class="c">####</span>
    <span class="c">###########################################################################</span>
 
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">sw_user</span> <span class="o">+</span> <span class="s">&#39;&gt; &#39;</span>
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrn</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="n">dblevel</span><span class="p">)</span>
        
        <span class="c">#reg = reg.encode()</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">reg</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;login: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;option :&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;root&gt;&quot;</span><span class="p">,</span> <span class="n">usrn</span><span class="p">,</span> <span class="n">telnet_closed</span> <span class="p">]</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="n">reg</span>
        <span class="n">reg_ex_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">usrn</span><span class="p">)</span>
        
        <span class="n">capture</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">,</span> <span class="mi">3600</span><span class="p">)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>
 
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fos_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">dl</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">sw_user</span> <span class="o">+</span> <span class="s">&#39;&gt; &#39;</span>
        <span class="n">usrn</span> <span class="o">=</span> <span class="n">usrn</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="c">#traff_prompt = &quot; ~]# &quot;</span>
        <span class="c">#traff_prompt = &quot;----------&quot;</span>
        <span class="c">#traff_prompt = &quot;]# &quot;</span>
        <span class="c">#traff_prompt = traff_prompt.encode()</span>
        
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s">&quot;hlogin: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;option :&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;root&gt;&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Forcing Failover ...&quot;</span><span class="p">,</span> <span class="n">usrn</span><span class="p">,</span> <span class="n">telnet_closed</span> <span class="p">]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="c">#capture = tn.expect(reg_ex_list, 60)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">capture</span>
 
    <span class="c">#except EOFError:</span>
        <span class="c">#print(&quot;========================&quot;)</span>
        <span class="c">#print(&quot;handle the EOF case here&quot;)</span>
        <span class="c">#print(&quot;========================&quot;)</span>
    <span class="c">#except SocketError as e:</span>
    <span class="c">#        if e.errno != errno.ECONNRESET:</span>
    <span class="c">#            print(&quot;\n\n\nCONNECTION ERROR TRYING TO RECONNECT\n\n\n&quot;)</span>
    <span class="c">#            raise </span>
    <span class="c">#        print(&quot;========================&quot;)</span>
    <span class="c">#        print(&quot;handle the EOF case here&quot;)</span>
    <span class="c">#        print(&quot;========================&quot;)           </span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">TELNET ERROR</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>       




<span class="k">def</span> <span class="nf">traff_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">dl</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span> 
         
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
   
        <span class="n">traff_prompt</span> <span class="o">=</span> <span class="s">&quot;]# &quot;</span>
        <span class="n">traff_prompt</span> <span class="o">=</span> <span class="n">traff_prompt</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
      
        <span class="c">#</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
        <span class="c">#reg_ex_list = [b&quot;hlogin: &quot;, b&quot;Password: &quot;, b&quot;option :&quot;, b&quot;root&gt;&quot;, b&quot;Forcing Failover ...&quot;, usrn, telnet_closed, traff_prompt ]</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">telnet_closed</span><span class="p">,</span> <span class="n">traff_prompt</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Administrator&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;admin&quot;</span><span class="p">]</span>
        
        <span class="n">capture</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="c">#capture = tn.expect(reg_ex_list, 60)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        
        
        <span class="k">return</span> <span class="n">capture</span>
 
    <span class="c">#except EOFError:</span>
        <span class="c">#print(&quot;========================&quot;)</span>
        <span class="c">#print(&quot;handle the EOF case here&quot;)</span>
        <span class="c">#print(&quot;========================&quot;)</span>
    <span class="c">#except SocketError as e:</span>
    <span class="c">#        if e.errno != errno.ECONNRESET:</span>
    <span class="c">#            print(&quot;\n\n\nCONNECTION ERROR TRYING TO RECONNECT\n\n\n&quot;)</span>
    <span class="c">#            raise </span>
    <span class="c">#        print(&quot;========================&quot;)</span>
    <span class="c">#        print(&quot;handle the EOF case here&quot;)</span>
    <span class="c">#        print(&quot;========================&quot;)           </span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">TELNET ERROR</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>       

    
    
<span class="k">def</span> <span class="nf">traff_output</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
            <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="n">traff_prompt</span> <span class="o">=</span> <span class="s">&quot;]# &quot;</span>
            <span class="n">traff_prompt</span> <span class="o">=</span> <span class="n">traff_prompt</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="n">traff_cpu</span> <span class="o">=</span> <span class="s">&quot;.*CPU \d+&quot;</span>
            <span class="n">traff_err</span> <span class="o">=</span> <span class="s">&quot;.*Read:\d+&quot;</span>
            <span class="n">traff_wrt</span> <span class="o">=</span> <span class="s">&quot;.*Write:\d+&quot;</span>
            
            <span class="n">traff_cpu</span> <span class="o">=</span> <span class="n">traff_cpu</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="n">traff_err</span> <span class="o">=</span> <span class="n">traff_err</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="n">traff_wrt</span> <span class="o">=</span> <span class="n">traff_wrt</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            
            <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
            <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">telnet_closed</span><span class="p">,</span> <span class="n">traff_prompt</span><span class="p">,</span> <span class="n">traff_cpu</span><span class="p">,</span> <span class="n">traff_err</span><span class="p">,</span> <span class="n">traff_wrt</span><span class="p">]</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">)</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s">&quot;]# &quot;</span> <span class="ow">in</span> <span class="n">capture</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">capture</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

  
<span class="k">def</span> <span class="nf">fos_cmd_regex_gen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span><span class="n">dblevel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
     <span class="c">###########################################################################</span>
    <span class="c">####   </span>
    <span class="c">####   to pass the reg make it a list and b style</span>
    <span class="c">####    reg_list = [b&#39;[my reg expression]&#39;, b&#39;second expression&#39; ]</span>
    <span class="c">####</span>
    <span class="c">####    gen since teh user name is not needed</span>
    <span class="c">###########################################################################</span>
 
    <span class="k">global</span> <span class="n">tn</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="c">#usrn = var.sw_user + &#39;&gt; &#39;</span>
        <span class="c">#usrn = usrn.encode()</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="s">&quot;telnet connection closed&quot;</span>
        <span class="n">telnet_closed</span> <span class="o">=</span> <span class="n">telnet_closed</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="n">dblevel</span><span class="p">)</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="c">#reg = reg.encode()</span>
        <span class="n">reg_ex_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">reg</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;login: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;Password: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;option :&quot;</span><span class="p">,</span> <span class="n">b</span><span class="s">&quot;root&gt;&quot;</span><span class="p">,</span> <span class="n">telnet_closed</span> <span class="p">]</span>
        <span class="c">#reg_ex_list = reg</span>
        <span class="c">#reg_ex_list.append(usrn)</span>
        
        <span class="n">capture</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        
        <span class="n">capture</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">reg_ex_list</span><span class="p">,</span> <span class="mi">3600</span><span class="p">)</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">capture</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">tn</span><span class="o">.</span><span class="n">set_debuglevel</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">capture</span><span class="p">)</span>
 
    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;handle the EOF case here&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;========================&quot;</span><span class="p">)</span>
        
    
<span class="k">def</span> <span class="nf">remote_os_ver</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">dl</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    
    <span class="c">###########################################################################</span>
    <span class="c">####  find the os type of remote switch</span>
    <span class="c">####    if the ip is not passed it will find the version of local switch</span>
    <span class="c">####</span>
    <span class="c">###########################################################################</span>
    
    <span class="n">db_level</span> <span class="o">=</span> <span class="n">dl</span>
    <span class="n">ras</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;ttl=([\d]{1,3})&#39;</span><span class="p">)</span>
    <span class="n">this_command</span> <span class="o">=</span> <span class="s">&quot;ping -c 1 &quot;</span> <span class="o">+</span> <span class="n">ip</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="s">&quot;]#&quot;</span>
    <span class="n">connect_tel_noparse</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">,</span><span class="s">&quot;root&quot;</span><span class="p">,</span> <span class="s">&quot;pass&quot;</span><span class="p">)</span>
    
    <span class="n">cmdout</span> <span class="o">=</span> <span class="n">fos_cmd_regex_gen</span><span class="p">(</span><span class="n">this_command</span><span class="p">,</span><span class="n">reg</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
    
    <span class="n">os_ver</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">cmdout</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">*</span><span class="mi">33</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">os_ver</span><span class="p">)</span>
    <span class="n">os_is</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os_ver</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;128&#39;</span><span class="p">:</span>
        <span class="n">os_is</span> <span class="o">=</span> <span class="s">&quot;windows&quot;</span>
    <span class="k">if</span> <span class="n">os_ver</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;64&#39;</span><span class="p">:</span>
        <span class="n">os_is</span> <span class="o">=</span> <span class="s">&quot;linux&quot;</span>
    
    
    <span class="n">close_tel</span><span class="p">()</span>
    

    <span class="k">return</span><span class="p">(</span><span class="n">os_is</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">SQA_automation 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, S_M.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>